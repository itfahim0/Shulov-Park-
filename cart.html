<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart - Shulov Park</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>

<body>

    <header>
        <div class="container nav-wrapper">
            <a href="index.html" class="logo">
                <img src="shulov_logo_transparent.png" alt="Shulov Park">
            </a>

            <div class="search-bar">
                <i class="fas fa-search search-icon"></i>
                <input type="text" placeholder="Search for fruits, vegetables, or daily essentials...">
                <div class="search-dropdown"></div>
            </div>

            <div class="nav-actions">
                <a href="account.html" class="nav-item">
                    <i class="fas fa-user-circle"></i>
                    <span>Account</span>
                </a>
                <a href="cart.html" class="nav-item">
                    <div style="position: relative;">
                        <i class="fas fa-shopping-basket"></i>
                        <span class="cart-count">0</span>
                    </div>
                    <span>Cart</span>
                </a>
            </div>
        </div>
    </header>

    <main class="container" style="padding-top: 3rem; padding-bottom: 3rem;">
        <h1 class="page-title">Shopping Cart</h1>

        <div class="cart-grid">
            <!-- Cart Table -->
            <div class="cart-table-container">
                <table class="cart-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Price</th>
                            <th>Quantity</th>
                            <th>Subtotal</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody id="cart-table-body">
                        <!-- JS populated -->
                    </tbody>
                </table>
            </div>

            <!-- Cart Summary -->
            <div class="cart-summary">
                <h3 style="margin-bottom: 1.5rem; font-size: 1.25rem;">Order Summary</h3>
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span id="cart-subtotal">৳0</span>
                </div>
                <div class="summary-row">
                    <span>Delivery Fee</span>
                    <span>৳60</span>
                </div>
                <div class="summary-row">
                    <span>Platform Fee</span>
                    <span>৳0</span>
                </div>
                <div class="summary-row total">
                    <span>Total Amount</span>
                    <span id="cart-total">৳0</span>
                </div>

                <a href="checkout.html" class="btn btn-primary"
                    style="width: 100%; text-align: center; margin-top: 1.5rem; font-size: 1.1rem;">
                    Proceed to Checkout
                </a>
                <a href="index.html"
                    style="display: block; text-align: center; margin-top: 1rem; color: var(--text-light); font-size: 0.9rem;">
                    or Continue Shopping
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-grid">
                <div class="footer-col">
                    <h4>Shulov Park</h4>
                    <p style="opacity: 0.7; line-height: 1.6;">Your trusted partner for fresh, organic, and affordable
                        groceries. Quality you can taste, prices you can trust.</p>
                </div>
                <div class="footer-col">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="#">About Us</a></li>
                        <li><a href="index.html">Shop</a></li>
                        <li><a href="#">Offers</a></li>
                        <li><a href="#">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Customer Service</h4>
                    <ul>
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Returns & Refunds</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4>Contact Us</h4>
                    <ul>
                        <li><i class="fas fa-map-marker-alt" style="margin-right: 8px;"></i> Dhaka, Bangladesh</li>
                        <li><i class="fas fa-phone" style="margin-right: 8px;"></i> +880 1234 567890</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                &copy; 2024 Shulov Park. All rights reserved.
            </div>
        </div>
    </footer>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-nav-bar">
        <a href="index.html" class="mobile-nav-item">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </a>
        <a href="index.html" class="mobile-nav-item">
            <i class="fas fa-search"></i>
            <span>Search</span>
        </a>
        <a href="cart.html" class="mobile-nav-item active">
            <div style="position: relative;">
                <i class="fas fa-shopping-basket"></i>
                <span class="cart-count" style="top: -5px; right: -5px;">0</span>
            </div>
            <span>Cart</span>
        </a>
        <a href="account.html" class="mobile-nav-item">
            <i class="fas fa-user"></i>
            <span>Account</span>
        </a>
    </nav>

    <script type="module">
        import { CartService } from './src/services/cart-service.js';

        document.addEventListener('DOMContentLoaded', () => {
            CartService.init();
            renderCartPage();
            updateCartCount();
        });

        window.renderCartPage = function () {
            const tbody = document.getElementById('cart-table-body');
            const subtotalEl = document.getElementById('cart-subtotal');
            const totalEl = document.getElementById('cart-total');

            if (!tbody) return;
            tbody.innerHTML = '';

            const cart = CartService.getCart();

            if (cart.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; padding: 2rem;">Your cart is empty</td></tr>';
                if (subtotalEl) subtotalEl.textContent = '৳0';
                if (totalEl) totalEl.textContent = '৳0';
                return;
            }

            cart.forEach(item => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>
                        <div class="cart-product">
                            <img src="${item.image}" alt="${item.name}">
                            <div class="cart-product-info">
                                <h4>${item.name}</h4>
                                <span>${item.unit ? 'per ' + item.unit : ''}</span>
                            </div>
                        </div>
                    </td>
                    <td>৳${item.price}</td>
                    <td>
                        <div class="qty-control">
                            <button class="qty-btn" onclick="updateQty(${item.id}, -1)">-</button>
                            <input type="number" class="qty-input" value="${item.qty}" readonly>
                            <button class="qty-btn" onclick="updateQty(${item.id}, 1)">+</button>
                        </div>
                    </td>
                    <td>৳${item.price * item.qty}</td>
                    <td>
                        <button class="remove-btn" onclick="removeFromCart(${item.id})"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            const subtotal = CartService.getCartTotal();
            if (subtotalEl) subtotalEl.textContent = '৳' + subtotal;
            if (totalEl) totalEl.textContent = '৳' + (subtotal + 60); // 60 delivery fee
        };

        // Expose global functions for onclicks
        window.updateQty = (id, change) => {
            CartService.updateQuantity(id, change);
            renderCartPage();
            updateCartCount();
        };

        window.removeFromCart = (id) => {
            CartService.removeFromCart(id);
            renderCartPage();
            updateCartCount();
        };

        function updateCartCount() {
            const el = document.querySelector('.cart-count');
            if (el) el.textContent = CartService.getItemCount();
        }
    </script>
</body>

</html>